# 最小二乗法についての幾何学的解釈

$y = w^T \phi$ の形でフィッティングさせるとき最小二乗解を幾何的に解釈することで正規方程式を導出する．

## 前提

教師データ $\{\phi_n, t_n\}$ があるとする．最小二乗誤差

$$
    \min E(w) = \frac{1}{2}\|T - \Phi w\|^2
$$

を基準とする

## 最小二乗誤差についての解釈

予測ベクトル $Y = \Phi w$ が教師ベクトル $T$ にユーグリッド距離でもっとも近いとき， $T$ を $\{\varphi_m\}$ で貼られる超平面への正射影が $Y$ である．

このとき予測ベクトル $\Phi w$ ベクトルと誤差ベクトル $T - \Phi w$ は直交する．

$$
    \begin{align*}
        <\Phi w, T - \Phi w> &= 0 \\
        w^T \Phi^T (T - \Phi w) &= 0 \\
        \Phi^T T - \Phi^T \Phi w &= 0\\
        w &= (\Phi^T \Phi)^{-1} \Phi^T T
    \end{align*}
$$

これは正規方程式である．とくに特徴次元とサンプルサイズがまったく同じとき $w = \Phi^{-1} T$.

また

$$
    \begin{align*}
        \Phi^{\dagger} := (\Phi^T \Phi)^{-1} \Phi^T
    \end{align*}
$$

をムーア・ペンローズの擬似逆行列という．(計画行列 $\Phi$ は $M\times N$ 行列なので逆行列は一般に存在しない． )